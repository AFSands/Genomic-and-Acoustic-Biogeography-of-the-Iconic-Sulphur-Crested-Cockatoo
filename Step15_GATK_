

#set the input file to process
name=$(sed -n ${SLURM_ARRAY_TASK_ID}p namelistChrom)

bcftools view -Oz -f .,PASS scc_twc_2ycc_combined_indelSNPs_vQSR_recalibrated_99_9_mappedChr_sort_Chr${name}.vcf.gz > scc_twc_2ycc_combined_indelSNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_Chr${name}.vcf.gz
tabix -p vcf scc_twc_2ycc_combined_indelSNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_Chr${name}.vcf.gz
vcftools --gzvcf scc_twc_2ycc_combined_indelSNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_Chr${name}.vcf.gz --remove-indels --max-missing 1 --min-meanDP 5 --max-meanDP 35 --recode --recode-INFO-all --out scc_twc_2ycc_combined_SNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_vcffilter_Chr${name} --stdout | bgzip -c > scc_twc_2ycc_combined_SNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_vcffilter_Chr${name}.vcf.gz
tabix -p vcf scc_twc_2ycc_combined_SNPs_vQSR_recalibrated_99_9_mappedChr_sort_pass_vcffilter_Chr${name}.vcf.gz

chmod -R 777 * 
